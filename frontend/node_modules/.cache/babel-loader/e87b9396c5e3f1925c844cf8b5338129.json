{"ast":null,"code":"import _slicedToArray from\"/Users/superlisa/dev/mesto-react/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import avatar from'../images/Photo-content/Avatar.jpg';import{useEffect,useState,useContext}from'react';import{api}from'../utils/Api.js';import Card from'./Card.js';import{CurrentUserContext}from'../contexts/CurrentUserContext.js';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Main(props){var onEditProfile=props.onEditProfile,onAddPlace=props.onAddPlace,onEditAvatar=props.onEditAvatar,onCardClick=props.onCardClick;// Подписываемся на контекст CurrentUserContext\nvar currentUser=useContext(CurrentUserContext);// const [currentUser, setCurrentUser] = useState({ name: 'Юлия', about: 'Fox', avatar: avatar });\nvar _useState=useState([]),_useState2=_slicedToArray(_useState,2),cards=_useState2[0],setCards=_useState2[1];var cardComponents=cards.map(function(card){return/*#__PURE__*/_jsx(Card,{card:card,onClick:onCardClick},card._id);});useEffect(function(){Promise.all([api.getInitialCards(),api.getUserInfo()]).then(function(initialCards){// setCurrentUser(userData);\nsetCards(initialCards);}).catch(function(err){console.log('//////Ошибка Promise.all//////',err);});},[]);function handleCardLike(card){// Снова проверяем, есть ли уже лайк на этой карточке\nvar isLiked=card.likes.some(function(i){return i._id===currentUser._id;});// Отправляем запрос в API и получаем обновлённые данные карточки\napi.changeLikeCardStatus(card._id,!isLiked).then(function(newCard){setCards(function(state){return state.map(function(c){return c._id===card._id?newCard:c;});});});}return/*#__PURE__*/_jsxs(\"main\",{className:\"content\",children:[/*#__PURE__*/_jsxs(\"section\",{className:\"profile\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"profile__avatar-button\",onClick:onEditAvatar,children:/*#__PURE__*/_jsx(\"img\",{src:currentUser.avatar,alt:\"\\u0410\\u0432\\u0430\\u0442\\u0430\\u0440\\u043A\\u0430\",className:\"profile__avatar\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile__info\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"profile__name-edit-button\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"profile__name\",children:currentUser.name}),/*#__PURE__*/_jsx(\"button\",{className:\"button profile__edit-button\",type:\"button\",onClick:onEditProfile,\"aria-label\":\"\\u0420\\u0435\\u0434\\u0430\\u043A\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"profile__description\",children:currentUser.about})]}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"button profile__add-button\",\"aria-label\":\"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C\",onClick:onAddPlace})]}),/*#__PURE__*/_jsx(\"section\",{className:\"elements\",\"aria-label\":\"\\u041A\\u0430\\u0440\\u0442\\u043E\\u0447\\u043A\\u0438\",children:/*#__PURE__*/_jsx(\"ul\",{className:\"elements-list\",children:cardComponents})})]});}export default Main;","map":{"version":3,"names":["avatar","useEffect","useState","useContext","api","Card","CurrentUserContext","Main","props","onEditProfile","onAddPlace","onEditAvatar","onCardClick","currentUser","cards","setCards","cardComponents","map","card","_id","Promise","all","getInitialCards","getUserInfo","then","initialCards","catch","err","console","log","handleCardLike","isLiked","likes","some","i","changeLikeCardStatus","newCard","state","c","name","about"],"sources":["/Users/superlisa/dev/mesto-react/src/components/Main.js"],"sourcesContent":["import avatar from '../images/Photo-content/Avatar.jpg';\nimport { useEffect, useState, useContext } from 'react';\nimport { api } from '../utils/Api.js';\nimport Card from './Card.js';\nimport { CurrentUserContext } from '../contexts/CurrentUserContext.js';\n\n\nfunction Main(props) {\n\n  const { onEditProfile, onAddPlace, onEditAvatar, onCardClick } = props;\n\n  // Подписываемся на контекст CurrentUserContext\n  const currentUser = useContext(CurrentUserContext);\n  // const [currentUser, setCurrentUser] = useState({ name: 'Юлия', about: 'Fox', avatar: avatar });\n  const [cards, setCards] = useState([]);\n\n  const cardComponents = cards.map((card) => (\n    <Card\n      key={card._id}\n      card={card}\n      onClick={onCardClick}\n    />\n  ));\n\n  useEffect(() => {\n    Promise.all([api.getInitialCards(), api.getUserInfo()])\n      .then((initialCards) => {\n        // setCurrentUser(userData);\n        setCards(initialCards);\n      })\n      .catch((err) => {\n        console.log('//////Ошибка Promise.all//////', err);\n      });\n  }, [])\n\n  function handleCardLike(card) {\n    // Снова проверяем, есть ли уже лайк на этой карточке\n    const isLiked = card.likes.some(i => i._id === currentUser._id);\n    \n    // Отправляем запрос в API и получаем обновлённые данные карточки\n    api.changeLikeCardStatus(card._id, !isLiked).then((newCard) => {\n        setCards((state) => state.map((c) => c._id === card._id ? newCard : c));\n    });\n}\n\n  return (\n    <main className=\"content\">\n      <section className=\"profile\">\n        <button className=\"profile__avatar-button\"\n          onClick={onEditAvatar}\n        >\n          <img\n            src={currentUser.avatar}\n            alt=\"Аватарка\"\n            className=\"profile__avatar\"\n          />\n        </button>\n        <div className=\"profile__info\">\n          <div className=\"profile__name-edit-button\">\n            <h1 className=\"profile__name\">{currentUser.name}</h1>\n            <button\n              className=\"button profile__edit-button\"\n              type=\"button\"\n              onClick={onEditProfile}\n              aria-label=\"Редактировать\"\n            />\n          </div>\n          <p className=\"profile__description\">{currentUser.about}</p>\n        </div>\n        <button\n          type=\"button\"\n          className=\"button profile__add-button\"\n          aria-label=\"Добавить\"\n          onClick={onAddPlace}\n        />\n      </section>\n\n      <section className=\"elements\" aria-label=\"Карточки\">\n        <ul className=\"elements-list\">{cardComponents}</ul>\n      </section>\n\n    </main>\n  )\n}\n\nexport default Main;"],"mappings":"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"},"metadata":{},"sourceType":"module"}